var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function l(t){return"function"==typeof t}function r(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function c(t,n){t.appendChild(n)}function i(t,n,e){t.insertBefore(n,e||null)}function s(t){t.parentNode.removeChild(t)}function u(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function a(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function f(){return p(" ")}function d(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function h(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function m(t,n){n=""+n,t.data!==n&&(t.data=n)}function g(t,n){(null!=n||t.value)&&(t.value=n)}function $(t,n,e,o){t.style.setProperty(n,e,o?"important":"")}let v;function b(t){v=t}function w(){if(!v)throw new Error("Function called outside component initialization");return v}function x(){const t=w();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const l=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);o.slice().forEach(n=>{n.call(t,l)})}}}const y=[],A=[],E=[],H=[],C=Promise.resolve();let T=!1;function _(t){E.push(t)}let P=!1;const k=new Set;function I(){if(!P){P=!0;do{for(let t=0;t<y.length;t+=1){const n=y[t];b(n),L(n.$$)}for(y.length=0;A.length;)A.pop()();for(let t=0;t<E.length;t+=1){const n=E[t];k.has(n)||(k.add(n),n())}E.length=0}while(y.length);for(;H.length;)H.pop()();T=!1,P=!1,k.clear()}}function L(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(_)}}const j=new Set;let q;function S(){q={r:0,c:[],p:q}}function G(){q.r||o(q.c),q=q.p}function M(t,n){t&&t.i&&(j.delete(t),t.i(n))}function N(t,n,e,o){if(t&&t.o){if(j.has(t))return;j.add(t),q.c.push(()=>{j.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}function O(t){t&&t.c()}function R(t,e,r){const{fragment:c,on_mount:i,on_destroy:s,after_update:u}=t.$$;c&&c.m(e,r),_(()=>{const e=i.map(n).filter(l);s?s.push(...e):o(e),t.$$.on_mount=[]}),u.forEach(_)}function U(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function F(t,n){-1===t.$$.dirty[0]&&(y.push(t),T||(T=!0,C.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function V(n,l,r,c,i,u,a=[-1]){const p=v;b(n);const f=l.props||{},d=n.$$={fragment:null,ctx:null,props:u,update:t,not_equal:i,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:[]),callbacks:e(),dirty:a};let h=!1;if(d.ctx=r?r(n,f,(t,e,...o)=>{const l=o.length?o[0]:e;return d.ctx&&i(d.ctx[t],d.ctx[t]=l)&&(d.bound[t]&&d.bound[t](l),h&&F(n,t)),e}):[],d.update(),h=!0,o(d.before_update),d.fragment=!!c&&c(d.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);d.fragment&&d.fragment.l(t),t.forEach(s)}else d.fragment&&d.fragment.c();l.intro&&M(n.$$.fragment),R(n,l.target,l.anchor),I()}b(p)}class z{$destroy(){U(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function B(t,n,e){const o=t.slice();return o[6]=n[e],o}function D(n){let e;return{c(){e=a("h1"),e.textContent="Loading..."},m(t,n){i(t,e,n)},p:t,d(t){t&&s(e)}}}function J(n){let e;return{c(){e=a("h1"),e.textContent="Unable to load poll"},m(t,n){i(t,e,n)},p:t,d(t){t&&s(e)}}}function K(t){let n,e,o,l,r,d=t[0].question+"",g=t[0].possibleAnswers,$=[];for(let n=0;n<g.length;n+=1)$[n]=Q(B(t,g,n));return{c(){n=a("div"),e=a("div"),o=p(d),l=f(),r=a("ul");for(let t=0;t<$.length;t+=1)$[t].c();h(e,"class","card-header"),h(r,"class","list-group list-group-flush"),h(n,"class","card")},m(t,s){i(t,n,s),c(n,e),c(e,o),c(n,l),c(n,r);for(let t=0;t<$.length;t+=1)$[t].m(r,null)},p(t,n){if(1&n&&d!==(d=t[0].question+"")&&m(o,d),5&n){let e;for(g=t[0].possibleAnswers,e=0;e<g.length;e+=1){const o=B(t,g,e);$[e]?$[e].p(o,n):($[e]=Q(o),$[e].c(),$[e].m(r,null))}for(;e<$.length;e+=1)$[e].d(1);$.length=g.length}},d(t){t&&s(n),u($,t)}}}function Q(t){let n,e,o,r,u,g,$,v=t[6].text+"";return{c(){n=a("li"),e=a("div"),o=p(v),r=f(),u=a("button"),u.textContent="Vote",g=f(),h(e,"class","pb-2"),h(u,"type","button"),h(u,"class","btn btn-primary float-right"),h(n,"class","list-group-item")},m(s,a,p){i(s,n,a),c(n,e),c(e,o),c(n,r),c(n,u),c(n,g),p&&$(),$=d(u,"click",(function(){l(t[2](t[6].id))&&t[2](t[6].id).apply(this,arguments)}))},p(n,e){t=n,1&e&&v!==(v=t[6].text+"")&&m(o,v)},d(t){t&&s(n),$()}}}function W(n){let e;function o(t,n){return"loaded"==t[1]?K:"loadError"==t[1]?J:D}let l=o(n),r=l(n);return{c(){e=a("main"),r.c()},m(t,n){i(t,e,n),r.m(e,null)},p(t,[n]){l===(l=o(t))&&r?r.p(t,n):(r.d(1),r=l(t),r&&(r.c(),r.m(e,null)))},i:t,o:t,d(t){t&&s(e),r.d()}}}function X(t,n,e){const o=x();let l={},r="loading",{pollApiHost:c=""}=n;return t.$set=t=>{"pollApiHost"in t&&e(3,c=t.pollApiHost)},[l,r,function(t){t&&l.id&&fetch(`${c}/api/poll/${l.id}/answer/${t}`,{method:"POST"}).then((function(t){if(!t.ok)throw new Error("HTTP status code"+t.status);o("pollResponseCompleted")})).catch((function(t){alert("Error while submitting answer")}))},c,function(t){e(1,r="loading"),t?fetch(`${c}/api/poll/${t}`,{method:"GET"}).then((function(t){if(!t.ok)throw new Error("HTTP status code"+t.status);return t.json()})).then((function(t){e(0,l=t),e(1,r="loaded")})).catch((function(t){e(1,r="loadError")})):e(1,r="loadError")}]}class Y extends z{constructor(t){super(),V(this,t,X,W,r,{pollApiHost:3,loadPoll:4})}get loadPoll(){return this.$$.ctx[4]}}function Z(t,n,e){const o=t.slice();return o[8]=n[e],o}function tt(n){let e;return{c(){e=a("h1"),e.textContent="Loading..."},m(t,n){i(t,e,n)},p:t,d(t){t&&s(e)}}}function nt(n){let e;return{c(){e=a("h1"),e.textContent="Unable to load poll results"},m(t,n){i(t,e,n)},p:t,d(t){t&&s(e)}}}function et(t){let n,e,o,l,r,d=t[0].question+"",g=t[0].possibleAnswers,$=[];for(let n=0;n<g.length;n+=1)$[n]=ot(Z(t,g,n));return{c(){n=a("div"),e=a("div"),o=p(d),l=f(),r=a("ul");for(let t=0;t<$.length;t+=1)$[t].c();h(e,"class","card-header"),h(r,"class","list-group list-group-flush"),h(n,"class","card")},m(t,s){i(t,n,s),c(n,e),c(e,o),c(n,l),c(n,r);for(let t=0;t<$.length;t+=1)$[t].m(r,null)},p(t,n){if(1&n&&d!==(d=t[0].question+"")&&m(o,d),1&n){let e;for(g=t[0].possibleAnswers,e=0;e<g.length;e+=1){const o=Z(t,g,e);$[e]?$[e].p(o,n):($[e]=ot(o),$[e].c(),$[e].m(r,null))}for(;e<$.length;e+=1)$[e].d(1);$.length=g.length}},d(t){t&&s(n),u($,t)}}}function ot(t){let n,e,o,l,r,u,d,g,v,b=t[8].text+"",w=t[8].responseCount+"";return{c(){n=a("li"),e=a("div"),o=p(b),l=f(),r=a("div"),u=a("div"),d=p(w),v=f(),h(e,"class","pb-2"),h(u,"class","progress-bar"),h(u,"role","progressbar"),$(u,"width",t[8].percentage+"%"),h(u,"aria-valuenow",g=t[8].percentage),h(u,"aria-valuemin","0"),h(u,"aria-valuemax","100"),h(r,"class","progress"),h(n,"class","list-group-item")},m(t,s){i(t,n,s),c(n,e),c(e,o),c(n,l),c(n,r),c(r,u),c(u,d),c(n,v)},p(t,n){1&n&&b!==(b=t[8].text+"")&&m(o,b),1&n&&w!==(w=t[8].responseCount+"")&&m(d,w),1&n&&$(u,"width",t[8].percentage+"%"),1&n&&g!==(g=t[8].percentage)&&h(u,"aria-valuenow",g)},d(t){t&&s(n)}}}function lt(n){let e;function o(t,n){return"loaded"==t[1]?et:"loadError"==t[1]?nt:tt}let l=o(n),r=l(n);return{c(){e=a("main"),r.c()},m(t,n){i(t,e,n),r.m(e,null)},p(t,[n]){l===(l=o(t))&&r?r.p(t,n):(r.d(1),r=l(t),r&&(r.c(),r.m(e,null)))},i:t,o:t,d(t){t&&s(e),r.d()}}}function rt(t,n,e){let o={},l="loading",{pollId:r=""}=n,{pollApiHost:c=""}=n;var i;function s(t){let n=t.possibleAnswers.reduce((function(t,n){return t+n.responseCount}),0);t.possibleAnswers.forEach((function(t){t.percentage=0,n>0&&(t.percentage=100*(t.responseCount/n).toFixed(2))})),e(0,o=t)}function u(){fetch(`${c}/api/poll/${r}`,{method:"GET"}).then((function(t){if(!t.ok)throw new Error("HTTP status code"+t.status);return t.json()})).then((function(t){s(t)})).catch((function(t){clearInterval(i)}))}return r?fetch(`${c}/api/poll/${r}`,{method:"GET"}).then((function(t){if(!t.ok)throw new Error("HTTP status code"+t.status);return t.json()})).then((function(t){s(t),i=setInterval(u,500),e(1,l="loaded")})).catch((function(t){e(1,l="loadError")})):l="loadError",t.$set=t=>{"pollId"in t&&e(2,r=t.pollId),"pollApiHost"in t&&e(3,c=t.pollApiHost)},[o,l,r,c]}class ct extends z{constructor(t){super(),V(this,t,rt,lt,r,{pollId:2,pollApiHost:3})}}function it(n){let e,l,r,u,p,m,$,v,b,w;return{c(){e=a("div"),l=a("div"),r=a("form"),u=a("div"),p=a("label"),p.textContent="Poll Id",m=f(),$=a("input"),v=f(),b=a("button"),b.textContent="View Poll",h(p,"for","poll"),h($,"type","text"),h($,"class","form-control"),h($,"id","poll"),h($,"placeholder","Identifier of the poll to view"),h(u,"class","form-group"),h(b,"type","button"),h(b,"class","btn btn-primary"),h(l,"class","col-lg-8 col-12"),h(e,"class","row justify-content-center")},m(t,s,a){i(t,e,s),c(e,l),c(l,r),c(r,u),c(u,p),c(u,m),c(u,$),g($,n[4]),c(r,v),c(r,b),a&&o(w),w=[d($,"input",n[8]),d(b,"click",n[6])]},p(t,n){16&n&&$.value!==t[4]&&g($,t[4])},i:t,o:t,d(t){t&&s(e),o(w)}}}function st(t){let n,e,o,l,r;const u=[at,ut],p=[];function f(t,n){return 0==t[2]?0:1}return o=f(t),l=p[o]=u[o](t),{c(){n=a("div"),e=a("div"),l.c(),h(e,"class","col-lg-8 col-12"),h(n,"class","row justify-content-center")},m(t,l){i(t,n,l),c(n,e),p[o].m(e,null),r=!0},p(t,n){let r=o;o=f(t),o===r?p[o].p(t,n):(S(),N(p[r],1,1,()=>{p[r]=null}),G(),l=p[o],l||(l=p[o]=u[o](t),l.c()),M(l,1),l.m(e,null))},i(t){r||(M(l),r=!0)},o(t){N(l),r=!1},d(t){t&&s(n),p[o].d()}}}function ut(t){let n;const e=new ct({props:{pollApiHost:t[0],pollId:t[3]}});return{c(){O(e.$$.fragment)},m(t,o){R(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.pollApiHost=t[0]),8&n&&(o.pollId=t[3]),e.$set(o)},i(t){n||(M(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){U(e,t)}}}function at(t){let n,e={pollApiHost:t[0]};const o=new Y({props:e});return t[7](o),o.$on("pollResponseCompleted",t[5]),{c(){O(o.$$.fragment)},m(t,e){R(o,t,e),n=!0},p(t,n){const e={};1&n&&(e.pollApiHost=t[0]),o.$set(e)},i(t){n||(M(o.$$.fragment,t),n=!0)},o(t){N(o.$$.fragment,t),n=!1},d(n){t[7](null),U(o,n)}}}function pt(t){let n,e,o,l,r,u,p,d,m;const g=[st,it],$=[];function v(t,n){return t[3]?0:1}return p=v(t),d=$[p]=g[p](t),{c(){n=a("main"),e=a("nav"),e.innerHTML='<span class="navbar-brand">Poll</span>',o=f(),l=a("div"),r=a("div"),r.innerHTML='<div class="col"> </div>',u=f(),d.c(),h(e,"class","navbar navbar-dark bg-primary"),h(r,"class","row"),h(l,"class","container-sm")},m(t,s){i(t,n,s),c(n,e),c(n,o),c(n,l),c(l,r),c(l,u),$[p].m(l,null),m=!0},p(t,[n]){let e=p;p=v(t),p===e?$[p].p(t,n):(S(),N($[e],1,1,()=>{$[e]=null}),G(),d=$[p],d||(d=$[p]=g[p](t),d.c()),M(d,1),d.m(l,null))},i(t){m||(M(d),m=!0)},o(t){N(d),m=!1},d(t){t&&s(n),$[p].d()}}}function ft(t,n,e){let o,l,r,c=!1,{pollApiHost:i}=n;var s;return s=()=>{var t=new URLSearchParams(window.location.search);e(3,l=t.get("poll"))},w().$$.on_mount.push(s),t.$set=t=>{"pollApiHost"in t&&e(0,i=t.pollApiHost)},t.$$.update=()=>{10&t.$$.dirty&&l&&o&&o.loadPoll(l)},[i,o,c,l,r,function(){e(2,c=!0)},function(){window.location="/?poll="+r.toLowerCase()},function(t){A[t?"unshift":"push"](()=>{e(1,o=t)})},function(){r=this.value,e(4,r)}]}return new class extends z{constructor(t){super(),V(this,t,ft,pt,r,{pollApiHost:0})}}({target:document.body,props:{pollApiHost:""}})}();
//# sourceMappingURL=bundle.js.map
